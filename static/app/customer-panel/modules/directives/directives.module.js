angular.module("APP",["ui.router","oc.lazyLoad","ngSanitize","satellizer"]).directive("dealTileDirective",function(){return{restrict:"E",scope:{items:"=items",class:"@className",limit:"@",orderBy:"@"},templateUrl:"static/app/customer-panel/modules/deal.details/deal.details.directive.template.html"}}).directive("comments",function(){return{restrict:"E",scope:{info:"="},controller:"commentsCtrl",templateUrl:"static/app/customer-panel/modules/comments/comments.directive.template.html"}}).directive("commentsDisplay",function(){return{restrict:"E",scope:{items:"="},templateUrl:"static/app/customer-panel/modules/comments/comments.display.template.html"}}).directive("couponInfoPopup",function(){return{restrict:"E",scope:{couponInfo:"=coupon",parent:"=",type:"@"},controller:"couponInfoPopupCtrl",templateUrl:"static/app/customer-panel/modules/coupon.info.popup/coupon.info.popup.directive.template.html"}}).directive("reports",function(){return{restrict:"E",scope:{info:"="},controller:["$scope","$state","$stateParams","$http","auth","$auth",function(t,e,o,n,r,i){t.issue={"Not Valid":"not valid",Expired:"expired","Other Issue":"other issue"},t.report={},r.me().then(function(e){t.loggeduser=e.data}),t.submitReport=function(e){n({url:"/api/1.0/coupons_reports",method:"POST",data:{user:t.loggeduser._id,coupon:t.info.item._id,status:!1,issue:e.issue,description:e.description}}).then(function(t){$("#reportPopup").modal("hide")},function(t){})}}],templateUrl:"static/app/customer-panel/modules/reports/reports.template.html"}}).controller("couponInfoPopupCtrl",["$scope","$http","$state","$ocLazyLoad","$sce","$stateParams","Query",function(t,e,o,n,r,i,c){n.load("static/bower_components/clipboard/dist/clipboard.min.js").then(function(e){t.showMore={},t.trustAsHtml=function(t){if(t)return r.trustAsHtml(t)},$("#couponPopup").on("hidden.bs.modal",function(){o.go(".",{cc:void 0})});var n=new Clipboard(".btn");n.on("success",function(t){t.clearSelection(),$("#copyClipboard").html("Copied to Clipboard")}),n.on("error",function(t){}),t.openCouponCode=function(t,e){var n="/api/1.0/coupons/"+e._id+"?number_of_clicks=1";c.get(n),n=o.href(o.current.name,{cc:e._id}),window.open(n,"_blank")},t.moreCoupons=[],url="/api/1.0/coupons?sort=-number_of_clicks&max_results=3",c.get(url).then(function(e){var o=e.data._items;t.moreCoupons=o})})}]).controller("commentsCtrl",["$scope","$state","$stateParams","auth","$auth","$http",function(t,e,o,n,r,i){t.comment={},n.me().then(function(e){t.loggeduser=e.data}),t.submitComment=function(e){i({url:"/api/1.0/coupons_comments",method:"POST",data:{user:t.loggeduser._id,coupon:t.info.item._id,status:!1,comment:e.comment}}).then(function(t){$("#commentPopup").modal("hide")},function(t){})}}]).factory("Query",["$http","$q",function(t,e){return{get:function(o){var n=e.defer();return t({url:o+"&r="+Math.random(),method:"GET"}).then(function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise}}}]);