angular.module("APP",["ui.router","oc.lazyLoad","ngSanitize","satellizer"]).directive("dealTileDirective",function(){return{restrict:"E",scope:{items:"=items",class:"@className",limit:"@",orderBy:"@"},templateUrl:"static/app/customer-panel/modules/deal.details/deal.details.directive.template.html"}}).directive("comments",function(){return{restrict:"E",scope:{info:"="},controller:"commentsCtrl",templateUrl:"static/app/customer-panel/modules/comments/comments.directive.template.html"}}).directive("commentsDisplay",function(){return{restrict:"E",scope:{items:"="},templateUrl:"static/app/customer-panel/modules/comments/comments.display.template.html"}}).directive("couponInfoPopup",function(){return{restrict:"E",scope:{couponInfo:"=coupon",parent:"=",type:"@"},controller:"couponInfoPopupCtrl",templateUrl:"static/app/customer-panel/modules/coupon.info.popup/coupon.info.popup.directive.template.html"}}).directive("reports",function(){return{restrict:"E",scope:{info:"="},controller:["$scope","$state","$stateParams","$http","auth","$auth",function(o,e,t,n,r,c){o.issue={"Not Valid":"not valid",Expired:"expired","Other Issue":"other issue"},o.report={},r.me().then(function(e){o.loggeduser=e.data}),o.submitReport=function(e){console.log("Report: ",e);n({url:"/api/1.0/coupons_reports",method:"POST",data:{user:o.loggeduser._id,coupon:o.info.item._id,status:!1,issue:e.issue,description:e.description}}).then(function(o){console.log("Report data Success: ",o),$("#reportPopup").modal("hide")},function(o){console.log(o)})}}],templateUrl:"static/app/customer-panel/modules/reports/reports.template.html"}}).controller("couponInfoPopupCtrl",["$scope","$http","$state","$ocLazyLoad","$sce","$stateParams","Query",function(o,e,t,n,r,c,s){console.log("couponInfoPopupCtrl: "),n.load("static/bower_components/clipboard/dist/clipboard.min.js").then(function(e){o.showMore={},o.stateUrls=c,o.trustAsHtml=function(o){if(o)return r.trustAsHtml(o)},$("#couponPopup").on("hidden.bs.modal",function(){t.go(".",{cc:void 0,destionationUrl:void 0})});var n=new Clipboard(".btn");n.on("success",function(o){console.info("Action:",o.action),console.info("Text:",o.text),console.info("Trigger:",o.trigger),o.clearSelection(),$("#copyClipboard").html("Copied")}),n.on("error",function(o){console.error("Action:",o.action),console.error("Trigger:",o.trigger)}),o.openCouponCode=function(o,e){var n="/api/1.0/coupons/"+e._id+"?number_of_clicks=1";s.get(n),n=t.href(t.current.name,{cc:e._id}),window.open(n,"_blank")},o.moreCoupons=[];var i=JSON.stringify({related_stores:1});url="/api/1.0/coupons?sort=-number_of_clicks&max_results=3&embedded="+i,s.get(url).then(function(e){var t=e.data._items;console.log(" Coupons Data: ",t),o.moreCoupons=t})})}]).controller("commentsCtrl",["$scope","$state","$stateParams","auth","$auth","$http",function(o,e,t,n,r,c){console.log("Comments controller!"),o.comment={},n.me().then(function(e){o.loggeduser=e.data}),o.submitComment=function(e){console.log("Comment Description: ",e.comment,"Store info: ",o.info.item.related_stores);c({url:"/api/1.0/coupons_comments",method:"POST",data:{user:o.loggeduser._id,coupon:o.info.item._id,status:!1,comment:e.comment}}).then(function(o){console.log("Comment data Success: ",o),$("#commentPopup").modal("hide")},function(o){console.log(o)})}}]).factory("Query",["$http","$q",function(o,e){return{get:function(t){var n=e.defer();return o({url:t+"&r="+Math.random(),method:"GET"}).then(function(o){n.resolve(o)},function(o){n.reject(o)}),n.promise}}}]);