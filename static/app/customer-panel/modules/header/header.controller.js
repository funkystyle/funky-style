angular.module("headerModule",["ui.bootstrap","APP"]).controller("headerCtrl",["$scope","auth","$state","$http","$filter","$q","HTTP","$location","$ocLazyLoad",function(e,t,o,a,r,n,l,i,s){e.isMobile=window.innerWidth<500,e.selectedSearch={search:void 0},s.load({files:[{type:"css",path:"static/bower_components/font-awesome-4.7.0/css/font-awesome.min.css"}]}),e.user={},e.featuredStores=[],e.totalItems=[],e.allStores=[],e.searchResults=function(e){return a.get("/api/1.0/search",{params:{q:e}}).then(function(e){return e.data.data})},localStorage.getItem("satellizer_token")&&t.me().then(function(t){e.user=t.data},function(e){localStorage.removeItem("satellizer_token")}),e.goClick=function(t){o.go("main."+t.type,{url:t.url,cc:t.cc}),e.selectedSearch.search=void 0};var c={projection:{name:1,url:1,image:1,featured_store:1,menu:1,related_coupons:1,"related_coupons.title":1,"related_coupons.url":1},embedded:{related_coupons:1},random_number:(new Date).getDate()};l.get(c,"stores").then(function(t){angular.forEach(t,function(t){1==t.featured_store&&e.featuredStores.push(t),e.allStores.push(t)})}),e.allCategories=[],delete c.featured_store,c.featured_category=1,l.get(c,"categories").then(function(t){e.allCategories=t}),e.logout=function(){localStorage.getItem("satellizer_token")&&a({url:"/api/1.0/auth/logout",method:"GET"}).then(function(e){localStorage.removeItem("satellizer_token"),o.go("main.login")},function(e){})}}]).factory("HTTP",["$http","$q",function(e,t){return{get:function(o,a){var r=t.defer(),n="/api/1.0/"+a+"?projection="+JSON.stringify(o.projection)+"&embedded="+JSON.stringify(o.embedded)+"&r="+Math.random();return e({url:n,mathod:"GET"}).then(function(e){if(e.data._items){var t=e.data._items;r.resolve(t)}},function(e){r.reject(e)}),r.promise}}}]);