angular.module("dealDetailsModule",["Directives"]).controller("dealDetailsCtrl",["$scope","$ocLazyLoad","$http","$state","$stateParams","$sce",function(e,t,a,r,o,d){if(e.deal={},e.showMore={},e.imageShow={},e.trustAsHtml=function(e){if(e)return d.trustAsHtml(e)},o.url){a({url:"/api/1.0/deals?where="+JSON.stringify({url:o.url})+"&number_of_clicks=1&embedded="+JSON.stringify({related_deals:1,deal_brands:1,deal_category:1,stores:1,"stores.store":1})+"&rand_number"+Math.random(),method:"GET"}).then(function(t){t.data&&t.data._items.length?(e.deal=t.data._items[0],e.deal.voting=Math.floor(201*Math.random())+300,e.deal.expired_date=new Date(e.deal.expired_date)):r.go("404")},function(e){}),e.top_stores=[];var n={name:1,url:1,image:1};a({url:"/api/1.0/stores?projection="+JSON.stringify(n)+"&rand_number"+(new Date).getTime(),method:"GET"}).then(function(t){t.data&&(e.top_stores=t.data._items)},function(e){})}}]);