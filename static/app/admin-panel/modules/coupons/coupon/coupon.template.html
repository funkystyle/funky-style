<link rel="stylesheet" href="/static/app/admin-panel/modules/coupons/coupon/coupon.css" />
<div class="panel panel-default" style="margin-top: 90px;">
    <div class="panel-heading">
        <div class="row">
            <div class="col-lg-6">
                <h1 style="margin-top: 10px;">
                    All Coupons
                </h1>
            </div>
            <!-- end col -->
            <div class="col-lg-2 pull-right">
                <a class="btn btn-sm btn-info pull-right" style="margin-top: 15px;" ui-sref="header.add-coupon">Add Coupon</a>
            </div>
        </div>
        <!-- end row -->
    </div>

    <div class="panel-body" cg-busy="load">
        <div class="row" style="margin-bottom: 30px;">
            <div class="col-lg-6 col-md-6">
                <span ng-click="filterByStatus(val)" ng-repeat="(key, val) in statusOptions">
                    <a class="btn btn-sm btn-default" href="">
                        {{ key }}  (<b>{{ val.length }}</b>)
                    </a> &nbsp;&nbsp;
                </span>
            </div>
        </div>
        <div class="row" style="margin-bottom: 30px;">
            <div class="col-md-2 col-sm-2">
                <label>By Store</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.related_stores" theme="bootstrap">
                    <ui-select-match placeholder="Select store">{{ $select.selected.name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in stores | filter: $select.search">
                        <div ng-bind-html="item.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By Category</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.related_categories" theme="bootstrap">
                    <ui-select-match placeholder="Select Category">{{ $select.selected.name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in categories | filter: $select.search">
                        <div ng-bind-html="item.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By User</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.last_modified_by" theme="bootstrap">
                    <ui-select-match placeholder="Select User">{{ $select.selected.first_name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in persons | filter: $select.search">
                        <div ng-bind-html="item.first_name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By Coupon types</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.coupon_type" theme="bootstrap">
                    <ui-select-match placeholder="Select Coupon type">{{ $select.selected }}</ui-select-match>
                    <ui-select-choices repeat="item in coupon_type | filter: $select.search">
                        <div ng-bind-html="item | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-lg-2 col-md-2">
                <a ng-click="clearAll()">Clear All</a>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 third-controller">
                <div class="row">
                    <div class="col-lg-2 col-xs-2 col-md-2 col-sm-2" ng-if="show && coupons.length">
                        <button style="margin-top: 20px;" class="btn btn-md btn-info"
                                ng-click="deleteSelected()">
                            Delete <b>{{ check.count }}</b> Item(s)
                        </button>
                    </div>
                    <div class="col-xs-2" ng-if="!show && coupons.length">
                        <label for="search">Search:</label>
                        <input ng-model="search.search" ng-change="updateFilteredList()" id="search" class="form-control input-sm" placeholder="Search...">
                    </div>
                    <div class="col-xs-2" ng-if="!show && coupons.length">
                        <label for="search">Items per page:</label>
                        <input type="number" min="1" max="200" class="form-control input-sm" ng-model="config.itemsPerPage">
                    </div>
                    <div class="col-lg-5 col-md-5 col-sm-12 pull-right">
                        <at-pagination class="pull-right" at-list="filterCoupons" at-config="config"></at-pagination>
                    </div>
                </div>
                <br>

                <table class="table table-striped table-bordered" at-table at-paginated at-list="filterCoupons" at-config="config">
                    <thead></thead>
                    <tbody>
                    <tr>
                        <td style="max-width: 50px;" at-title="#" width="10">
                            <div class="checkbox" style="word-wrap: break-word; margin-top: 5px; line-height: 30px;">
                                <label for="check_box_store_{{ item._id }}" style="font-weight: 500;">
                                    <input id="check_box_store_{{ item._id }}" type="checkbox"
                                           ng-model="check.check[item._id]" ng-change="checkBox()" />
                                    <span id="span_for_select_{{ item._id }}" class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
                                    <span></span>
                                </label>
                            </div>
                        </td>
                        <td at-title="Title" class="coupon-name" width="120" style="max-width: 120px;">
                            <p>{{ item.title }}</p>
                            <p class="coupon-options">
                                <span><a href="">View</a></span> &nbsp;&nbsp;
                                <span><a ui-sref="header.update-coupon({couponId: item._id})">Edit</a></span>
                            </p>
                        </td>
                        <td at-title="Submitted By" width="100">
                            {{ item.last_modified_by.first_name }} {{ item.last_modified_by.last_name }}
                        </td>
                        <td at-title="Store Name" width="100">
                            {{ item.related_stores[0].name }}
                        </td>
                        <td at-title="Related Categories" width="100">
                            <span ng-repeat="i in item.related_categories">
                                <a href="#/category/update/{{ i._id }}">
                                    {{ i.name }}
                                </a>
                                {{$last ? '' : ($index == item.related_categories.length-2) ? ' and ' : ', '}}
                            </span>
                        </td>
                        <td at-title="Coupon Type" width="100">
                            {{ item.coupon_type }}
                        </td>
                        <td at-title="Coupon" width="100">
                            {{ item.coupon_code }}
                        </td>
                        <td at-title="Created On" width="100">{{ item._created }}</td>
                        <td at-title="Expired on" width="100">
                            {{ item.expire_date | date: "dd MMM yyyy HH:MM a"}}
                        </td>
                        <td at-title="Clicks/Votes" width="100">
                            {{ item.clicks }}
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- end row -->
    </div>
    <!-- end panel-body -->
</div>


<!-- delete popup -->
<div class="delete-popup" id="sidebar-affix">
    <div class="delete-close" ng-click="toggleSidebar()">
        <i class="fa fa-close"></i>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <h1>Are you Sure?</h1>
            <p><b>Fatima</b> store will be deleted permanently!!</p>
        </div>
    </div>

    <div class="row" style="margin-top: 30px;">
        <div class="col-lg-2">
            <button class="btn btn-block btn-md btn-danger">Yes</button>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-12">
            <button class="btn btn-block btn-md btn-default" ng-click="toggleSidebar()">No</button>
        </div>
    </div>
</div>
<!-- delete popup -->