<link rel="stylesheet" href="/static/app/admin-panel/modules/store/store/store.css" />

<div class="panel panel-default" style="margin-top: 90px;">
    <div class="panel-heading">
        <div class="row">
            <div class="col-lg-6">
                <h1 style="margin-top: 10px;">
                    All Deals
                </h1>
            </div>
            <!-- end col -->
            <div class="col-lg-2 pull-right">
                <a class="btn btn-sm btn-info pull-right" style="margin-top: 15px;"
                   ui-sref="header.add-deal">Add Deal</a>
            </div>
        </div>
        <!-- end row -->

        <div class="row" style="margin-bottom: 30px;">
            <div class="col-md-2 col-sm-2">
                <label>By Store</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.store" theme="bootstrap">
                    <ui-select-match placeholder="Select Store">{{ $select.selected.name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in stores | orderBy: 'name' | filter: $select.search">
                        <div style="text-transform: capitalize;" ng-bind-html="item.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By Deal Category</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.deal_category" theme="bootstrap">
                    <ui-select-match placeholder="Select Deal Category">{{ $select.selected.name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in categories | orderBy: 'name' | filter: $select.search">
                        <div style="text-transform: capitalize;" ng-bind-html="item.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By User</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.last_modified_by" theme="bootstrap">
                    <ui-select-match placeholder="Select User">{{ $select.selected.first_name }}</ui-select-match>
                    <ui-select-choices repeat="item._id as item in persons | orderBy: 'first_name' | filter: $select.search">
                        <div style="text-transform: capitalize;">{{ item.first_name | highlight: $select.search }} {{ item.last_name | highlight: $select.search }}</div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-md-2 col-sm-2">
                <label>By Deal Type</label>
                <ui-select on-select="applyTypeFilter()" ng-model="filter.deal_type" theme="bootstrap">
                    <ui-select-match placeholder="Select Deal Types">{{ $select.selected }}</ui-select-match>
                    <ui-select-choices repeat="item in deal_types | orderBy: 'item' | filter: $select.search">
                        <div style="text-transform: capitalize;" ng-bind-html="item | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <div class="col-lg-2 col-md-2">
                <label style="visibility: hidden;">Clear All</label>
                <div class="form-group">
                    <button ng-click="clearAll()" class="btn btn-md btn-default">Clear All</button>
                </div>
            </div>
        </div>
    </div>

    <div class="panel-body" cg-busy="load">
        <div class="row">
            <div class="col-xs-12 third-controller">
                <div class="row">
                    <div class="col-lg-2 col-xs-2 col-md-2 col-sm-2" ng-if="show && deals.length">
                        <button style="margin-top: 20px;" class="btn btn-md btn-info"
                                ng-click="deleteSelected()">
                            Delete <b>{{ check.count }}</b> Item(s)
                        </button>
                    </div>
                    <div class="col-xs-2" ng-if="!show && deals.length">
                        <label for="search">Search:</label>
                        <input ng-model="search.search" ng-change="updateFilteredList()" id="search" class="form-control input-sm" placeholder="Search...">
                    </div>
                    <div class="col-xs-2" ng-if="!show && deals.length">
                        <label for="search">Items per page:</label>
                        <input type="number" min="1" max="200" class="form-control input-sm" ng-model="config.itemsPerPage">
                    </div>
                    <div class="col-lg-5 col-md-5 col-sm-12 pull-right">
                        <at-pagination class="pull-right" at-list="filterDeals" at-config="config"></at-pagination>
                    </div>
                </div>
                <br>

                <table class="table table-striped table-bordered" at-table at-paginated at-list="filterDeals" at-config="config">
                    <thead></thead>
                    <tbody>
                    <tr>
                        <td style="max-width: 50px;" at-title="Select" width="10">
                            <div class="checkbox" style="word-wrap: break-word; margin-top: 5px; line-height: 30px;">
                                <label for="check_box_store_{{ item._id }}" style="font-weight: 500;">
                                    <input id="check_box_store_{{ item._id }}" type="checkbox"
                                           ng-model="check.check[item._id]" ng-change="checkBox(item._id)" />
                                    <span id="span_for_select_{{ item._id }}" class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
                                    <span></span>
                                </label>
                            </div>
                        </td>
                        <td  class="coupon-name" at-title="Name" at-sortable width="250">
                            <p>{{ item.name }}</p>
                            <p class="coupon-options">
                                <span><a href="/deals/{{ item.url }}" target="_blank">View</a></span> &nbsp;&nbsp;
                                <span><a ui-sref="header.update-deal({id: item._id})">Edit</a></span>
                            </p>
                        </td>
                        <td at-title="Deal Type" at-sortable width="200">{{ item.deal_type }}</td>
                        <td at-title="Submitted By" width="100">
                            {{ item.last_modified_by.first_name }} {{ item.last_modified_by.last_name }}
                        </td>
                        <td at-title="Store Name" width="100">
                            {{ item.store.name }}
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- end row -->
    </div>
    <!-- end panel-body -->
</div>